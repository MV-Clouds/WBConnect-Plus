<template>
    <div class="forgot-container slds-grid slds-wrap slds-align_center" style={backgroundStyle}>
        <img src={logoUrl} alt="WBConnect Plus" class="logo"/>
        <div class="slds-col slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-around_large slds-text-align_center">
            <div class="forgot-box slds-p-around_large">
                <div class="slds-m-bottom_medium slds-text-align--left navigationText">
                    <a href={startUrl} target="_self">Back to Login</a>
                </div>
                <template if:true={isEmailPage}>
                    <h1 class="slds-text-heading_large slds-m-bottom_small forgotHeading">Forgot Your Password?</h1>
                    <p class="slds-text-body_small slds-m-bottom_large">Don't worry, happens to all of us. Enter your email below to recover your password</p>
                    <div class="slds-form slds-text-align_left">
                        <lightning-input type="email" label="Email" name="email" placeholder="your.email@example.com" value={email}
                            onchange={handleEmailChange} required class="slds-m-bottom_medium" message-when-value-missing="Email is required">
                        </lightning-input>
    
                        <template if:true={error}>
                            <div class="slds-text-color_error slds-m-bottom_small" role="alert">
                                {error}
                            </div>
                        </template>

                        <template if:true={message}>
                            <div class="slds-text-color_success slds-m-bottom_small" role="alert">
                                {message}
                            </div>
                        </template>
    
                         <template if:true={isLoading}>
                            <div class="slds-is-relative slds-m-vertical_medium spinner-container">
                                <lightning-spinner alternative-text="Loading..." size="medium"></lightning-spinner>
                            </div>
                        </template>
    
                        <lightning-button label="Submit" variant="brand" onclick={handleSubmit} disabled={isDisbaled} class="slds-button slds-button_stretch"></lightning-button>
                    </div>
                </template>
                <template if:true={isVerifyCodePage}>
                    <h1 class="slds-text-heading_large slds-m-bottom_small forgotHeading">Verify Code</h1>
                    <p class="slds-text-body_small slds-m-bottom_large">An authentication code has been sent to your email.</p>
                    <div class="slds-form slds-text-align_left">
                        <lightning-input type="email" label="Enter Code" name="number" max-length="6" placeholder="123456" value={verificationCode}
                            onchange={handleCodeChange} required class="slds-m-bottom_medium" message-when-value-missing="Code is required">
                        </lightning-input>
    
                        <template if:true={error}>
                            <div class="slds-text-color_error slds-m-bottom_small" role="alert">
                                {error}
                            </div>
                        </template>
    
                         <template if:true={isLoading}>
                            <div class="slds-is-relative slds-m-vertical_medium spinner-container">
                                <lightning-spinner alternative-text="Loading..." size="medium"></lightning-spinner>
                            </div>
                        </template>
    
                        <lightning-button label="Verify" variant="brand" onclick={handleVerify} disabled={isLoading} class="slds-button slds-button_stretch"></lightning-button>
                    </div>
                </template>
                <template if:true={isSetPasswordPage}>
                    <h1 class="slds-text-heading_large slds-m-bottom_small forgotHeading">Set a password</h1>
                    <p class="slds-text-body_small slds-m-bottom_large">Your previous password has been reseted. Please set a new password for your account.</p>
                    <div class="slds-form slds-text-align_left">
                        
                        <lightning-input type="password" label="Create Password" name="password" placeholder="********" value={newpassword}
                            onchange={handleNewPasswordChange} required class="slds-m-bottom_small" message-when-value-missing="Password is required">
                        </lightning-input>

                        <lightning-input type="password" label="Re-Enter Password" name="password" placeholder="********" value={repassword}
                            onchange={handleRePasswordChange} required class="slds-m-bottom_small" message-when-value-missing="Password is required">
                        </lightning-input>
    
                        <template if:true={error}>
                            <div class="slds-text-color_error slds-m-bottom_small" role="alert">
                                {error}
                            </div>
                        </template>
    
                         <template if:true={isLoading}>
                            <div class="slds-is-relative slds-m-vertical_medium spinner-container">
                                <lightning-spinner alternative-text="Loading..." size="medium"></lightning-spinner>
                            </div>
                        </template>
    
                        <lightning-button label="Set Password" variant="brand" onclick={handleSetPassword} disabled={isLoading} class="slds-button slds-button_stretch"></lightning-button>
                    </div>
                </template>
            </div>
        </div>
        <div class="slds-col slds-size_1-of-1 slds-medium-size_6-of-12 slds-p-around_large">
            <div class="illustration-container">
                <template if:true={isEmailPage}>
                    <img src={forgotPassIllustration} alt="Forgot Illustration" class="forgot-illustration-image">
                </template>
                <template if:true={isVerifyCodePage}>
                    <img src={verifyCodeillustration} alt="Verify Illustration" class="verify-illustration-image">
                </template>
                <template if:true={isSetPasswordPage}>
                    <img src={setPasswordIllustration} alt="Verify Illustration" class="setPass-illustration-image">
                </template>
            </div>
       </div>
       <div class="mvcFooterImg">
            <img src={poweredByMVC} alt="Powered by MVC" class="powered-by-mvc">
       </div>
    </div>
</template>
